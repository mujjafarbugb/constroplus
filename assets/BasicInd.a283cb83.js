import{u as Z,r as o,Q as y,j as r,a as l,L as T,F as S}from"./index.5a85093a.js";import{H as D}from"./HomeBredCurbs.f5cc8246.js";import{c as ee}from"./camPic.50111723.js";import{c as te,a as x,u as ae,o as le}from"./array.a2581f0b.js";import{T as u}from"./Textinput.a54277f9.js";import{u as re}from"./formik.esm.b8ddf936.js";import{I as se}from"./index.7a426a8b.js";import{M as oe}from"./index.91645ed2.js";import{a as f}from"./axios.74c9240f.js";import"./index.8b4fbb18.js";import"./index.esm.27038d76.js";import"./iconBase.ebd08f81.js";const E=te({firmRepresentative:x().required("Feild is Required."),userName:x().required("Username is Required."),homeCity:x().required("Home city is Required."),mobile:x().required("Mobile number is Required.").matches(/^[0-9]+$/,"Mobile number must contain only numbers").length(10,"Mobile number must be exactly 10 digits")}),Ie=()=>{Z();const M=localStorage.getItem("user"),h=JSON.parse(M),[i,v]=o.exports.useState({stateID:"",stateName:"",cityID:"",cityName:"",pincode:"",address:""}),[a,n]=o.exports.useState({userRegID:h.user._id,userName:"",homeCity:"",profile:"",mobile:"",alternateMobile:"",email:"",password:"",categoryId:"",categoryType:"",firmName:"",firmType:"",firmRepresentative:"",representativeDesignation:"",website:"",preferredCities:"",yearOfEst:"",remark:"",fcmToken:"",regFrom:"",regOn:"",lastModified:"",isActive:!0});o.exports.useState("");const[O,P]=o.exports.useState(),[ie,F]=o.exports.useState(""),[p,C]=o.exports.useState([]);o.exports.useState([]),o.exports.useState(),o.exports.useState([]);const[k,V]=o.exports.useState([]),[N,B]=o.exports.useState([]),[ne,Y]=o.exports.useState([]),[A,H]=o.exports.useState(),[_,q]=o.exports.useState(!1),[U,j]=o.exports.useState(!1),[I,R]=o.exports.useState(!1),$=1900,J=2100;o.exports.useEffect(()=>{h&&h.user&&h.user._id?(n({...a,userRegID:h.user._id}),f.get(`https://constrobackend17-4.onrender.com/api/get_service_receiver_userregId/${h.user._id}`).then(t=>{if(console.log(66,t),!t.data.Result)y.error(t.data.message);else{j(!0);const e=t.data.Result;localStorage.setItem("profile",JSON.stringify(e)),console.log(96,e),P(e.updateCount),H(e._id),C(e.preferredCities),v(e.address),n({...a,firmName:e==null?void 0:e.firmName,userName:e==null?void 0:e.userName,homeCity:e==null?void 0:e.homeCity,profile:e==null?void 0:e.profile,mobile:e==null?void 0:e.mobile,alternateMobile:e==null?void 0:e.alternateMobile,email:e==null?void 0:e.email,password:e==null?void 0:e.password,categoryId:e==null?void 0:e.categoryId,categoryType:e==null?void 0:e.categoryType,firmName:e==null?void 0:e.firmName,firmType:e==null?void 0:e.firmType,firmRepresentative:e==null?void 0:e.firmRepresentative,representativeDesignation:e==null?void 0:e.representativeDesignation,website:e==null?void 0:e.website,preferredCities:e==null?void 0:e.preferredCities,yearOfEst:e==null?void 0:e.yearOfEst,remark:e==null?void 0:e.remark,fcmToken:e==null?void 0:e.fcmToken,regFrom:e==null?void 0:e.regFrom,regOn:e==null?void 0:e.regOn})}}).catch(t=>{console.log(t)})):console.error("Invalid user data:",h),f.get("https://constrobackend17-4.onrender.com/api/getAll_States_ddl").then(t=>{V(t.data.Result)}).catch(t=>{console.log(t)}),f.get("https://constrobackend17-4.onrender.com/api/getAll_Cities_ddl").then(t=>{console.log(112,t.data.Result),B(t.data.Result)}).catch(t=>{console.log(t)}),f.get("https://constrobackend17-4.onrender.com/api/get_all_categories").then(t=>{console.log(1,t.data.Result),Y(t.data.Result)}).catch(t=>{console.log(t)})},[I]);const L=t=>{console.log(62,a),console.log(63,i);const e={...a,address:i};console.log(117,"Data Posted",e),e&&f.post("https://constrobackend17-4.onrender.com/api/post_service_receiver",e).then(s=>{s.data,console.log(130,s.data),y.success("Submitted Successfully."),R(!I)}).catch(s=>{console.error("API Error:",s.message),y.error("Submission failed. Please try again.")})},W=t=>{console.log(62,a),console.log(63,i);const e={...a,address:i};console.log(117,"Data Posted",e),e&&f.put(`https://constrobackend17-4.onrender.com/api/update_service_receiver/${A}`,e).then(s=>{s.data,console.log(130,s.data),y.success(s.data.message),R(!I)}).catch(s=>{console.error("API Error:",s.message),y.error("Submission failed. Please try again.")})},{register:c,formState:{errors:m},handleSubmit:ce}=ae({resolver:le(E),mode:"all"}),g=re({initialValues:{firmName:"",firmRepresentative:"",representativeDesignation:"",userName:"",mobile:"",alternateMobile:"",email:"",website:"",pincode:"",homeCity:"",preferredCities:null,address:null,remark:"",userCode:"",categoryId:null,categoryType:"",stateID:null,stateName:null,regFrom:"",regOn:null,lastModified:"",year:"",firmType:""},validationSchema:E,onSubmit:t=>{console.log(122,t)}}),w=[];for(let t=$;t<=J;t++)w.push(t);const Q=t=>{const e=t.target.value,s=t.target.name;F(e),console.log("Selected Category:",e),n({...a,[s]:e})},z=t=>{const e=t.target.value,s=k.filter(b=>b._id===e);console.log("Selected state:",s[0].state),v({...i,stateID:s[0]._id,stateName:s[0].state})},G=()=>{q(!_)},K=t=>{const{value:e,checked:s}=t.target,b=N.find(d=>d._id===e);if(s)if(p.length<3){const d=[...p,{cityId:e,cityName:b.city}];console.log(333,d),C(d),n({...a,preferredCities:d})}else alert("You can only select up to three cities.");else C(p.filter(d=>d.cityId!==e)),n({...a,preferredCities:p.filter(d=>d.cityId!==e).map(d=>d.cityId)})},X=t=>{const e=t.target.value;console.log(e);const s=N.find(b=>b._id===e);console.log(s),s?(console.log("Selected city:",s.city),v({...i,cityID:s._id,cityName:s.city})):console.error("Error: Selected city not found")};return r("div",{children:[l(D,{title:"Basic Info "}),r("div",{className:"flex items-center text-slate-400 ",children:[r(T,{to:"",className:"flex items-center text-sm hover:underline hover:font-semibold hover:text-blue-400 cursor-pointer gap-1",onClick:()=>{window.history.back()},children:[l(se,{className:"text-xl font-semibold"}),"Back"]}),l("span",{className:"mx-2",children:" / "}),r(T,{to:"/dashboard",className:"flex items-center text-sm  hover:underline hover:font-semibold hover:text-blue-400 cursor-pointer gap-1",children:[l(oe,{className:"text-lg font-semibold"}),"Home"]})]}),l("div",{className:"row mt-3",children:r("div",{className:"col-lg-12",children:[l("img",{className:"h-[90px] w-[90px] rounded-md opacity-60",src:ee,alt:""}),r("span",{className:"text-sm text-slate-400 font-normal",children:["Last Modified On : 15-Feb-2024"," "]}),l("form",{onSubmit:g.handleSubmit,children:r("div",{className:"row mt-3",children:[r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm name"}),l(u,{name:"firmName",type:"text",placeholder:"Firm name",register:c,error:m.firmName,className:"",value:a.firmName,defaultValue:a.firmName?a.firmName:"",onChange:t=>{n({...a,firmName:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputPassword1",class:"form-label",children:"Representative"}),l(u,{name:"firmRepresentative",type:"text",placeholder:"Representative",register:c,error:m.firmRepresentative,className:"",value:a.firmRepresentative,defaultValue:a.firmRepresentative?a.firmRepresentative:"",onChange:t=>{n({...a,firmRepresentative:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputPassword1",class:"form-label",children:"Designation"}),l(u,{name:"representativeDesignation",type:"text",placeholder:"Enter designation",register:c,error:m.representativeDesignation,className:"",value:a.representativeDesignation,defaultValue:a.representativeDesignation?a.representativeDesignation:"",onChange:t=>{n({...a,representativeDesignation:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Username",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),l(u,{name:"userName",type:"text",placeholder:"Username",register:c,error:m.userName,className:"",value:a.userName,defaultValue:a.userName?a.userName:"",onChange:t=>{n({...a,userName:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Mobile Number",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),l(u,{name:"mobile",type:"text",placeholder:"Phone number",register:c,error:m.mobile,className:"",value:a.mobile,defaultValue:a.mobile?a.mobile:"",onChange:t=>{n({...a,mobile:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputPassword1",class:"form-label",children:"Alternate Mobile Number"}),l(u,{name:"alternateMobile",type:"text",placeholder:"Phone number",register:c,error:m.alternateMobile,className:"",value:a.alternateMobile,defaultValue:a.alternateMobile?a.alternateMobile:"",onChange:t=>{n({...a,alternateMobile:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Email address"}),l(u,{name:"email",type:"email",placeholder:" Enter your email",register:c,error:m.email,className:"",value:a.email,defaultValue:a.email?a.email:"",onChange:t=>{n({...a,email:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Website"}),l(u,{name:"website",type:"text",placeholder:"Website link",register:c,error:m.website,className:"",value:a.website,defaultValue:a.website?a.website:"",onChange:t=>{n({...a,website:t.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Pincode"}),l(u,{name:"pincode",type:"number",placeholder:"Pincode",register:c,error:m.pincode,className:"",value:i.pincode,defaultValue:i.pincode?i.pincode:"",onChange:t=>{v({...i,pincode:t.target.value})}})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["State",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm text-slate-500",id:"exampleInputYear","aria-describedby":"emailHelp",name:"stateName",value:i.stateID,defaultValue:i.stateID?i.stateID:"",onChange:t=>z(t),onBlur:g.handleBlur,children:[l("option",{value:"",children:"Select state"},""),k.map(t=>l("option",{value:t._id,children:t.state},t._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["Home City",l("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm text-slate-500",id:"exampleInputYear","aria-describedby":"emailHelp",name:"homeCity",value:i.cityID,defaultValue:i.cityID,onChange:X,onBlur:g.handleBlur,children:[l("option",{value:"",className:"",children:"Select City"},""),N.map(t=>l("option",{value:t._id,children:t.city},t._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[l("label",{htmlFor:"cityInput",className:"form-label",children:"Operational Cities"}),r("div",{className:"custom-select",children:[l("input",{type:"text",className:"form-control bg-white",placeholder:"Select Cities",value:p.map(t=>t.cityName).join(", "),defaultValue:p.map(t=>t.cityName).join(", "),readOnly:!0,onClick:G}),_&&l("div",{className:"select-options my-2",children:N.map(t=>r("div",{className:"form-check ",children:[l("input",{className:"form-check-input",type:"checkbox",id:t._id,value:t._id,checked:p.map(e=>e.cityId).includes(t._id),onChange:K,disabled:p.length>=3&&!p.includes(t._id)}),l("label",{className:"form-check-label text-sm",htmlFor:t.city,children:t.city})]},t._id))})]})]}),r("div",{className:"mb-3 col-lg-6",children:[l("label",{htmlFor:"exampleInputYear",className:"form-label",children:"Starting Year"}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"yearOfEst",value:a.yearOfEst,defaultValue:a.yearOfEst,onChange:Q,onBlur:g.handleBlur,children:[l("option",{value:"",className:"",children:"Select Year"}),w.map(t=>l("option",{value:t,children:t},t))]}),g.touched.year&&g.errors.year&&l("div",{className:"text-red-500 text-sm p-1",children:g.errors.year})]}),r("div",{className:"mb-3 col-lg-6",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm Type"}),l(u,{name:"firmType",type:"text",placeholder:"Enter firm type..",register:c,error:m.firmType,className:"",value:a.firmType,defaultValue:a.firmType,onChange:t=>{n({...a,firmType:t.target.value})}})]}),r("div",{className:"mb-3 col-lg-12",children:[l("label",{for:"exampleInputEmail1",class:"form-label",children:"Remark"}),l(u,{name:"remark",type:"text",placeholder:"",register:c,error:m.remark,className:"",value:a.remark,defaultValue:a.remark,onChange:t=>{n({...a,remark:t.target.value})},id:"floatingTextarea2"})]}),U?l(S,{children:O<3&&l(S,{children:l("button",{type:"submit",className:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:t=>W(),children:"Update"})})}):l(S,{children:l("button",{type:"submit",className:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:t=>L(),children:"Submit"})})]})})]})})]})};export{Ie as default};
