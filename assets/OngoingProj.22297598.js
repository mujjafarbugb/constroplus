import{u as F,r as i,Q as g,j as a,a as e,F as _}from"./index.5a85093a.js";import"./index.esm.27038d76.js";import{B}from"./index.e2082948.js";import{M as v,B as k}from"./Modal.f44a4947.js";import{T as c}from"./Textinput.a54277f9.js";import{b as O}from"./index.91645ed2.js";import{a as p}from"./axios.74c9240f.js";import"./iconBase.ebd08f81.js";const M=()=>{F();const[m,h]=i.exports.useState(!1),[d,C]=i.exports.useState([]),[u,y]=i.exports.useState([]),[l,s]=i.exports.useState({client:"",project:"",scope:"",scopeId:"",billValue:"",workValue:"",workCompleted:"",isCompleted:!1,remark:""}),j=localStorage.getItem("user"),w=JSON.parse(j),V=localStorage.getItem("profile"),b=JSON.parse(V);i.exports.useEffect(()=>{p.get(`https://constrobackend17-4.onrender.com/api/get_service_provider_regid/${w.user._id}`).then(t=>{if(console.log(66,t),!t.data.Result)g.error(t.data.message);else{h(!0),console.log("Data Fetch",t.data.Result);const r=t.data.Result.projectList.filter(x=>x.isCompleted===!1);console.log(22,r);const n=t.data.Result;console.log("Show Data",n.projectList),C(r)}}).catch(t=>{console.log(t)}),p.get("https://constrobackend17-4.onrender.com/api/get_all_expertise").then(t=>{console.log(t.data.Result),y(t.data.Result)}).catch(t=>{console.error("Error fetching expertise data:",t)})},[m]);const N=()=>{const t={projectList:[...d,{...l}]};console.log(72,t),p.put(`https://constrobackend17-4.onrender.com/api/update_Service_Provider/${b._id}`,t).then(o=>{console.log("res",o)}).catch(o=>{console.log(o)}),h(!m)},f=t=>{const o=t.target.value,r=u.find(n=>String(n._id)===String(o));console.log("Selected Scope:",r),s({...l,scope:r.expertise,scopeId:r._id})},P=t=>{d[t];const o=d.filter((n,x)=>x!==t);console.log(o);const r={projectList:o};console.log(72,r),p.put(`https://constrobackend17-4.onrender.com/api/update_Service_Provider/${b._id}`,r).then(n=>{console.log("res",n)}).catch(n=>{console.log(n)}),h(!m)},S=t=>{const o=parseFloat(t.target.value),r=parseFloat(l.billValue);if(isNaN(o))s({...l,workValue:"",workCompleted:""});else if(o>r){const n=(r/o*100).toFixed(2);s({...l,workValue:o,workCompleted:n})}else s({...l,workValue:o,workCompleted:""}),g.error("Work Order Value must be greater than Bill Value")};return a("div",{className:"shadow-md p-4",children:[a("div",{className:"flex justify-between items-center",children:[e("span",{className:"my-4 text-lg font-semibold text-slate-500",children:"Ongoing Projects"}),e("div",{children:e(v,{title:"",label:"Add Projects + ",labelClass:"bg-[#00adee] hover:bg-[#6fcaeb] text-white",uncontrol:!0,footerContent:e(k,{text:"Add Project",className:"w-full bg-[#00adee] hover:bg-[#6fcaeb] text-white",onClick:()=>{N()}}),children:a("div",{className:"text-base text-slate-600 dark:text-slate-300 mt-2",children:[e(c,{label:"Client name",type:"text",placeholder:"",value:l.client,onChange:t=>s({...l,client:t.target.value})}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Project name"}),e(c,{type:"text",placeholder:"",class:"my-2",value:l.project,onChange:t=>s({...l,project:t.target.value})})]}),a("div",{className:"input-group mt-2",children:[e("label",{htmlFor:"cityInput",className:"form-label",children:"Select Expertise"}),a("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"expertiseId",value:l.scopeId,onChange:f,children:[e("option",{value:"",children:"Select Expertise"})," ",u.map(t=>e("option",{value:t._id,children:t.expertise},t._id))]})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Bill Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.billValue,onChange:t=>s({...l,billValue:t.target.value})})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Work Order Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.workValue,onChange:S})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Work Completed(%)"}),e(c,{type:"text",placeholder:"\u20B9",value:l.workCompleted,defaultValue:l.workCompleted,onChange:t=>s({...l,workCompleted:t.target.value})})]}),a("div",{class:"mb-2  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Remark"}),e(c,{type:"text",placeholder:"",value:l.remark,onChange:t=>s({...l,remark:t.target.value})})]})]})})})]}),e("div",{class:"overflow-x-auto",children:a("table",{class:"table-auto w-full shadow-sm rounded-md mt-3",children:[e("thead",{class:"border border-collapse bg-[#00adee] text-white",children:a("tr",{className:" rounded-md",children:[e("th",{class:"px-4 py-2 text-center border",children:"Client"}),e("th",{class:"px-4 py-2 text-center border",children:"Projects"}),e("th",{class:"px-4 py-2 text-center border",children:"Scope"}),e("th",{class:"px-4 py-2 text-center border",children:"Bill Value"}),e("th",{class:"px-4 py-2 text-center border",children:"Work Order Value"}),e("th",{class:"px-4 py-2 text-center border",children:"Work Completed(%)"}),e("th",{class:"px-4 py-2 text-center border",children:"Remark"}),e("th",{class:"px-4 py-2 text-center border",children:"Action"})]})}),e("tbody",{children:d==null?void 0:d.map((t,o)=>e(_,{children:a("tr",{className:"hover:bg-[#f8f8f8] shadow-sm",children:[e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.client}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.project}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.scope}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.billValue}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.workValue}),a("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:[t.workCompleted,"%"]}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.remark}),a("td",{className:"px-4 py-2 text-center flex justify-center text-sm text-slate-500",children:[e("div",{className:"cursor-pointer hover:text-[#00adee]",children:e(v,{title:"",label:e(B,{className:"text-3xl"}),labelClass:"",uncontrol:!0,footerContent:e(k,{text:"Update Project",className:"w-full bg-[#00adee] hover:bg-[#6fcaeb] text-white"}),children:a("div",{className:"text-base text-slate-600 dark:text-slate-300 mt-2",children:[e(c,{label:"Client name",type:"text",placeholder:"",value:l.client,onChange:r=>s({...l,client:r.target.value})}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Project name"}),e(c,{type:"text",placeholder:"",class:"my-2",value:l.project,onChange:r=>s({...l,project:r.target.value})})]}),a("div",{className:"input-group mt-2",children:[e("label",{htmlFor:"cityInput",className:"form-label",children:"Select Expertise"}),a("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"expertiseId",value:l.scopeId,onChange:f,children:[e("option",{value:"",children:"Select Expertise"})," ",u.map(r=>e("option",{value:r._id,children:r.expertise},r._id))]})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Bill Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.billValue,onChange:r=>s({...l,billValue:r.target.value})})]}),a("div",{class:"  mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Work Order Value"}),e(c,{type:"text",placeholder:"\u20B9",value:l.workValue,onChange:r=>s({...l,workValue:r.target.value})})]}),a("div",{class:"  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Work Completed(%)"}),e(c,{type:"text",placeholder:"%",value:l.workCompleted,onChange:r=>s({...l,workCompleted:r.target.value})})]}),a("div",{class:"mb-2  mt-2",children:[e("label",{for:"formFile",class:"form-label",children:"Remark"}),e(c,{type:"text",placeholder:"",value:l.remark,onChange:r=>s({...l,remark:r.target.value})})]})]})})}),e("td",{class:"px-4 py-2 text-sm text-slate-500 flex justify-center",children:e("button",{onClick:()=>P(o),children:e(O,{className:"text-3xl cursor-pointer hover:text-[#00adee]"})})})]})]})}))})]})})]})};export{M as default};
