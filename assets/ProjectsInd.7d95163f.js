import{u as J,b as Q,r as i,j as a,a as e,F as P,L as w,Q as f}from"./index.5a85093a.js";import{H as z}from"./HomeBredCurbs.f5cc8246.js";import{B as G}from"./index.e2082948.js";import{M as K,B as W}from"./Modal.f44a4947.js";import{T as g}from"./Textinput.a54277f9.js";import{I as X}from"./index.7a426a8b.js";import{M as Y}from"./index.91645ed2.js";import{c as Z,u as ee,o as te}from"./array.a2581f0b.js";import{u as ae}from"./formik.esm.b8ddf936.js";import{a as u}from"./axios.74c9240f.js";import"./index.esm.27038d76.js";import"./iconBase.ebd08f81.js";const F=Z({}),fe=()=>{J();const{id:R}=Q();console.log(9,R);const D=localStorage.getItem("profile"),p=JSON.parse(D);console.log(31,p._id);const[y,L]=i.exports.useState(""),[v,B]=i.exports.useState([]),[N,j]=i.exports.useState([]),[_,b]=i.exports.useState(!1),[C,M]=i.exports.useState(!1),[r,s]=i.exports.useState({projectName:"",buildings:"",city:"",location:"",remark:""}),I=()=>new Date().toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),[l,d]=i.exports.useState({receiverId:p._id,buildings:"",projectName:"",city:"",location:"",remark:"",regFrom:"web",regOn:I(),isActive:!0}),A=t=>{if(console.log(87,l),l){if(!l.projectName||!l.city||!l.location||!l.remark||!l.buildings){f.error("Please fill all required fields",{position:"top-right"});return}({...l},u.post("https://constrobackend17-4.onrender.com/api/post_projects",l).then(o=>{o.data,console.log(46,o),f.success("Submission successful!",{position:"top-right"}),b(!1),M(!C)}).catch(o=>{console.error("API Error:",o)}))}};i.exports.useEffect(()=>{u.get("https://constrobackend17-4.onrender.com/api/getAll_Cities_ddl").then(t=>{console.log(79,t.data.Result),B(t.data.Result),s(t.data.Result),s(l)}).catch(t=>{console.log(t)}),u.get(`https://constrobackend17-4.onrender.com/api/getProjectByReceiver/${p._id}`).then(t=>{console.log(100,t.data.Result),j(t.data.Result)}).catch(t=>{console.log(t)})},[C]);const{register:c,formState:{errors:m},handleSubmit:le}=ee({resolver:te(F),mode:"all"});ae({initialValues:{},validationSchema:F,onSubmit:t=>{console.log(122,t)}});const k=t=>{const o=t.target.value;L(o),d({...l,city:o})},U=()=>{window.history.back()},V=t=>{console.log(600,t),s(t)},E=t=>{const{_id:o,projectName:S,buildings:O,city:re,location:H,remark:T,selectedCity:$}=t,n={projectName:S,buildings:O,city:$,location:H,remark:T};console.log(199,"Updated Data:",n),u.put(`https://constrobackend17-4.onrender.com/api/update_projects/${o}`,n).then(h=>{console.log(46,h),f.success("Update Project Successfully!",{position:"top-right"});const q=N.map(x=>x._id===o?{...x,projectName:n.projectName,buildings:n.buildings,city:n.city,location:n.location,remark:n.remark}:x);j(q)}).catch(h=>{console.error("API Error:",h)})};return console.log(601,r),a("div",{children:[a("div",{className:"flex justify-between items-center",children:[e(z,{title:"List of Projects"}),e("div",{children:e(K,{title:"",label:" + Add Projects ",labelClass:"bg-[#00adee] hover:bg-[#6fcaeb] text-white",uncontrol:!0,isOpen:_,onClose:()=>b(!1),footerContent:e(W,{text:"Add Project",className:"bg-[#00adee] hover:bg-[#6fcaeb] text-white ",onClick:()=>{A(),b(!1),onClose()}}),children:a("div",{className:"text-xs text-slate-600 dark:text-slate-300 mt-2",children:[a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Project Name"}),e("input",{type:"text",name:"projectName",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:c,error:m.projectName,value:l.projectName,onChange:t=>{d({...l,projectName:t.target.value})}})]}),a("div",{class:"input-group mb-3 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Select City"}),a("select",{name:"city",class:"form-select text-sm text-slate-500","aria-label":"Default select example",onChange:k,value:y,children:[e("option",{value:"",selected:!0,children:"Select city"}),v.map((t,o)=>e(P,{children:e("option",{value:t._id,children:t.city})}))]})]}),a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Location"}),e("input",{type:"text",name:"location",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:c,error:m.location,value:l.location,onChange:t=>{d({...l,location:t.target.value})}})]}),a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Building Name"}),e("input",{type:"text",name:"buildings",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:c,error:m.buildings,value:l.buildings,onChange:t=>{d({...l,buildings:t.target.value})}})]}),a("div",{class:"input-group mb-2 mt-3",children:[e("label",{for:"formFile",class:"form-label",children:"Remark"}),e("input",{type:"text",name:"remark",class:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:c,error:m.remark,value:l.remark,onChange:t=>{d({...l,remark:t.target.value})}})]})]})})})]}),a("div",{className:"flex items-center text-slate-400 ",children:[a(w,{to:"",className:"flex items-center text-sm hover:underline hover:font-semibold hover:text-blue-400 cursor-pointer gap-1",onClick:U,children:[e(X,{className:"text-xl font-semibold"}),"Back"]}),e("span",{className:"mx-2",children:" / "}),a(w,{to:"/dashboard",className:"flex items-center text-sm  hover:underline hover:font-semibold hover:text-blue-400 cursor-pointer gap-1",children:[e(Y,{className:"text-lg font-semibold"}),"Home"]})]}),e("div",{class:"overflow-x-auto",children:a("table",{class:"table-auto w-full shadow-sm rounded-md mt-3",children:[e("thead",{class:"border border-collapse bg-[#00adee] hover:bg-[#6fcaeb] text-white",children:a("tr",{className:" rounded-md",children:[e("th",{class:"px-4 py-2 text-center border",children:"Project"}),e("th",{class:"px-4 py-2 text-center border",children:"Buildings"}),e("th",{class:"px-4 py-2 text-center border",children:"City"}),e("th",{class:"px-4 py-2 text-center border",children:"Location"}),e("th",{class:"px-4 py-2 text-center border",children:"Remark"}),e("th",{class:"px-4 py-2 text-center border",children:"Action"})]})}),a("tbody",{children:[e("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e("div",{class:"modal-dialog",children:a("div",{class:"modal-content",children:[a("div",{class:"modal-header text-white bg-[#00adee]",children:[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e("div",{class:"modal-body",children:a("form",{children:[a("div",{class:"mb-3",children:[e("label",{for:"projectName",class:"form-label text-left",children:"Project name"}),e(g,{name:"projectName",type:"text",placeholder:"Project",register:c,className:"",value:r.projectName,defaultValue:r.projectName,onChange:t=>s({...r,projectName:t.target.value})})]}),a("div",{className:"input-group mb-3 mt-2",children:[e("label",{htmlFor:"formFile",className:"form-label text-left",children:"Select City"}),a("select",{name:"city",className:"form-select text-sm text-slate-500","aria-label":"Default select example",onChange:t=>{k(t),s({...r,selectedCity:t.target.value})},defaultValue:r.selectedCity,children:[e("option",{value:"",disabled:!0,children:"Select city"}),v.map((t,o)=>e("option",{value:t._id,children:t.city},o))]})]}),e("label",{for:"projectName",class:"form-label text-left",children:"Location"}),e(g,{name:"location",type:"text",placeholder:"Location",register:c,className:"mb-2",value:r.location,defaultValue:r.location,onChange:t=>s({...r,location:t.target.value})}),a("div",{className:"input-group mb-2 mt-2",children:[e("label",{htmlFor:"formFile",className:"form-label text-left",children:"Building Name"}),e("input",{type:"text",name:"buildings",className:"form-control",placeholder:"","aria-label":"Recipient's username","aria-describedby":"button-addon2",register:c,value:r.buildings,defaultValue:r.buildings,onChange:t=>s({...r,buildings:t.target.value})})]}),e("label",{for:"projectName",class:"form-label text-left",children:"Remark"}),e(g,{name:"remark",type:"text",placeholder:"",register:c,className:"",value:r.remark,defaultValue:r.remark,onChange:t=>s({...r,remark:t.target.value})})]})}),a("div",{class:"modal-footer",children:[e("button",{type:"button",class:"btn btn-secondary border-0","data-bs-dismiss":"modal",children:"Cancel"}),e("button",{type:"button",class:"btn btn-primary border-0 bg-[#00adee]",onClick:t=>{E(r)},children:"Update Project"})]})]})})}),N.map((t,o)=>e(P,{children:a("tr",{className:"hover:bg-[#f8f8f8] shadow-sm",children:[e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.projectName}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.buildings}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.city.city}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.location}),e("td",{class:"px-4 py-2 text-center text-sm text-slate-500",children:t.remark}),e("td",{className:"px-4 py-2 text-center flex justify-center text-sm text-slate-500 ",children:e("div",{className:"cursor-pointer hover:text-[#00adee]",children:e("button",{type:"button",class:"btn border-0","data-bs-toggle":"modal","data-bs-target":"#exampleModal","data-bs-whatever":"@mdo",onClick:S=>{V(t)},children:e(G,{className:"text-3xl"})})})})]})}))]})]})})]})};export{fe as default};
