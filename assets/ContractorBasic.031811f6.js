import{u as ge,r as n,Q as N,a as t,j as r,F as q}from"./index.5a85093a.js";import"./index.esm.27038d76.js";import{c as ve}from"./camPic.50111723.js";import{c as Ne,a as h,b as xe,u as ye,o as Ce}from"./array.a2581f0b.js";import{T as d}from"./Textinput.a54277f9.js";import{u as Se}from"./formik.esm.b8ddf936.js";import{a as g}from"./axios.74c9240f.js";const L=Ne({firmtype:h().required("Please select a firm type."),represent:h().required("Feild is Required."),designation:h().required("Designation is Required."),username:h().required("Username is Required."),homecity:h().required("Home city is Required."),opcity:xe().min(1,"At least one city must be selected"),selectedYear:h().required("Please select a starting year."),Staff:h().required("Please select a number of staff."),labourCount:h().required("Please select a current labour strength."),expertise:h().required("Please select a expertise."),mobNo:h().required("Mobile number is Required.").matches(/^[0-9]+$/,"Mobile number must contain only numbers").length(10,"Mobile number must be exactly 10 digits")});function Me(){ge();const Q=localStorage.getItem("user"),b=JSON.parse(Q),[m,x]=n.exports.useState({stateID:"",stateName:"",cityID:"",cityName:"",pincode:"",address:""}),[a,o]=n.exports.useState({userName:"",userRegID:b.user._id,firmName:"",firmRepresentative:"",firmType:"",representativeDesignation:"",representativeEducation:"",representativeQualification:"",mobile:"",alternateMobile:"",email:"",website:"",pincode:"",expertiseId:"",preferredCities:null,homeCity:"",yearOfEst:"",staffCount:"",labourCount:"",authorisedApplicators:"",panNo:"",pfNo:"",gstNo:"",remark:""}),[H,G]=n.exports.useState([]),[Ie,U]=n.exports.useState(),[ke,j]=n.exports.useState([]),[E,$]=n.exports.useState([]),[f,C]=n.exports.useState([]),[Ee,J]=n.exports.useState([]),[Pe,W]=n.exports.useState(""),[De,z]=n.exports.useState(""),[Fe,K]=n.exports.useState(""),[P,D]=n.exports.useState(!1),[F,_]=n.exports.useState(!1),[w,R]=n.exports.useState(!1),[A,X]=n.exports.useState(!1),[y,Z]=n.exports.useState([]),[ee,ae]=n.exports.useState(!1),te=()=>{X(!A)},{register:i,formState:{errors:c},handleSubmit:_e}=ye({resolver:Ce(L),mode:"all"}),V=e=>{const l={...a,address:m};console.log(117,"Data Posted",l),g.post("https://constrobackend17-4.onrender.com/api/post_service_provider",l).then(s=>{console.log(130,s.data),N.success("Submitted Successfully.")}).catch(s=>{console.error("API Error:",s.message),N.error("Submission failed. Please try again.")})},le=e=>{const l={...a,address:m};console.log(117,"Data Posted",l),g.post("https://constrobackend17-4.onrender.com/api/post_service_provider",l).then(s=>{console.log(130,s.data),N.success("Submitted Successfully.")}).catch(s=>{console.error("API Error:",s.message),N.error("Submission failed. Please try again.")})},u=Se({initialValues:a||{firmName:"",firmRepresentative:"",representativeDesignation:"",userName:"",mobile:"",alternateMobile:"",email:"",website:"",pincode:"",homeCity:"",preferredCities:null,address:null,remark:"",userCode:"",categoryId:null,categoryType:"",stateID:null,regFrom:"",regOn:null,lastModified:"",year:"",firmType:""},validationSchema:L,onSubmit:V}),S=(e,l)=>{l(e.target.checked)},re=1900,se=2100,T="Ltd",Y=2100,O="Ltd",M=2100,B=[];for(let e=re;e<=se;e++)B.push(e);const oe=["proprietor","partnership","LLP","Pvt Ltd","Ltd","HUF"],ne=e=>{const l=e.target.value,s=e.target.name;K(l),console.log("Selected Category:",l),o({...a,[s]:l})},I=["Less than 5","5 - 10","10 - 20","20 - 50","50 - 100","100 - 200","More than 200"];n.exports.useEffect(()=>{b&&b.user&&b.user._id?(o({...a,userRegID:b.user._id}),g.get(`https://constrobackend17-4.onrender.com/api/get_service_provider_regid/${b.user._id}`).then(e=>{if(console.log(66,e),!e.data.Result)N.error(e.data.message);else{ae(!0),console.log("Data Fetch",e.data.Result);const l=e.data.Result;localStorage.setItem("profile",JSON.stringify(l)),console.log("Show Data",l.firmName),C(l.preferredCities),x(l.address),D(!!l.gstNo),_(!!l.pfNo),R(!!l.panNo),o({...a,userName:l.userName,userRegID:l.userRegID,firmName:l.firmName,firmRepresentative:l.firmRepresentative,firmType:l.firmType,representativeDesignation:l.representativeDesignation,representativeEducation:l.representativeEducation,representativeQualification:l.representativeQualification,mobile:l.mobile,alternateMobile:l.alternateMobile,email:l.email,website:l.website,pincode:l.pincode,expertiseId:l.expertiseId,preferredCities:l.preferredCities,homeCity:l.homeCity,yearOfEst:l.yearOfEst,staffCount:l.staffCount,labourCount:l.labourCount,authorisedApplicators:l.authorisedApplicators,panNo:l.panNo,pfNo:l.pfNo,gstNo:l.gstNo,remark:l.remark})}}).catch(e=>{console.log(e)})):console.error("Invalid user data:",b),g.get("https://constrobackend17-4.onrender.com/api/get_all_expertise").then(e=>{console.log(e.data.Result),G(e.data.Result)}).catch(e=>{console.error("Error fetching expertise data:",e)}),g.get("https://constrobackend17-4.onrender.com/api/getAll_Cities_ddl").then(e=>{console.log(112,e.data.Result),Z(e.data.Result)}).catch(e=>{console.log(e)}),g.get("https://constrobackend17-4.onrender.com/api/getAll_States_ddl").then(e=>{$(e.data.Result)}).catch(e=>{console.log(e)})},[]);for(let e=O;e<=M;e++)I.push(e);const ie=["Less than 25","25 - 50","50 - 100","100 - 200","200 - 400","400 - 800","More than 800"];for(let e=O;e<=M;e++)I.push(e);const ce=e=>{const l=e.target.value,s=e.target.name;J(l),console.log("Selected Category:",l),o({...a,[s]:l})},k=["Pre Graduate","Diploma","Graduate","Post Graduate","Other"];for(let e=T;e<=Y;e++)k.push(e);for(let e=T;e<=Y;e++)k.push(e);const de=e=>{const l=e.target.value,s=e.target.name;U(l),console.log("Selected firm type:",l),o({...a,[s]:l})},me=e=>{const l=e.target.value,s=e.target.name;z(l),console.log("Selected labour :",l),o({...a,[s]:l})},ue=e=>{const l=e.target.value,s=e.target.name;j(l),console.log("Selected staff :",l),o({...a,[s]:l})},pe=e=>{const l=e.target.value,s=e.target.name;console.log("Selected Experties :",l),W(event.target.value),o({...a,[s]:l})},he=e=>{const l=e.target.value,s=y.find(v=>v._id===l);s?(console.log("Selected city:",s.city),o({...a,homeCity:s.city})):console.error("Error: Selected city not found")},fe=e=>{const{value:l,checked:s}=e.target,v=y.find(p=>p._id===l);if(s)if(f.length<3){const p=[...f,{cityId:l,cityName:v.city}];console.log(333,p),C(p),o({...a,preferredCities:p})}else alert("You can only select up to three cities.");else C(f.filter(p=>p.cityId!==l)),o({...a,preferredCities:f.filter(p=>p.cityId!==l).map(p=>p.cityId)})},be=e=>{const l=e.target.value,s=E.filter(v=>v._id===l);console.log("Selected state:",s[0].state),x({...m,stateID:s[0]._id,stateName:s[0].state})};return t("div",{children:r("div",{className:"row mt-3 shadow-md p-3",children:[t("span",{className:"my-4 text-lg font-semibold text-slate-500",children:"Basic details"}),r("div",{className:"col-lg-12",children:[t("img",{className:"h-[90px] w-[90px] rounded-md opacity-60",src:ve,alt:""}),r("span",{className:"text-sm text-slate-400 font-normal",children:["Last Modified On : 15-Feb-2024"," "]}),t("form",{onSubmit:u.handleSubmit,children:r("div",{className:"row mt-3",children:[r("div",{class:"mb-3 col-lg-6",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm name"}),t(d,{name:"firmName",type:"text",placeholder:"Firm name",register:i,error:c.firmName,className:"",value:a.firmName,defaultValue:a.firmName?a.firmName:"",onChange:e=>{o({...a,firmName:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Representative",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),t(d,{name:"firmRepresentative",type:"text",placeholder:"",register:i,error:c.firmRepresentative,className:"",value:a.firmRepresentative,defaultValue:a.firmRepresentative?a.firmRepresentative:"",onChange:e=>{o({...a,firmRepresentative:e.target.value})}})]}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"firmType",value:a.firmType,defaultValue:a.firmType?a.firmType:"",onChange:de,onBlur:u.handleBlur,children:[t("option",{value:"",children:"select Firm Type"}),oe.map(e=>t("option",{value:e,children:e},e))]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Designation",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),t(d,{name:"representativeDesignation",type:"text",placeholder:"",register:i,error:c.representativeDesignation,className:"",value:a.representativeDesignation,defaultValue:a.representativeDesignation?a.representativeDesignation:"",onChange:e=>{o({...a,representativeDesignation:e.target.value})}})]}),r("div",{className:"mb-3 col-lg-6",children:[t("label",{htmlFor:"exampleInputYear",className:"form-label",children:"Select Education"}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"representativeEducation",value:a.representativeEducation,defaultValue:a.representativeEducation?a.representativeEducation:"",onChange:ce,onBlur:u.handleBlur,children:[t("option",{value:"",className:"",children:"Select Education"}),k.map(e=>t("option",{value:e,children:e},e))]})]}),r("div",{class:"mb-3 col-lg-6",children:[t("label",{for:"exampleInputPassword1",class:"form-label",children:"Qualification"}),t(d,{name:"representativeQualification",type:"text",placeholder:"Qualification",register:i,error:c.representativeQualification,className:"",value:a.representativeQualification,defaultValue:a.representativeQualification?a.representativeQualification:"",onChange:e=>{o({...a,representativeQualification:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Username",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),t(d,{name:"userName",type:"text",placeholder:"Username",register:i,error:c.userName,className:"",value:a.userName,defaultValue:a.userName?a.userName:"",onChange:e=>{o({...a,userName:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[r("label",{for:"exampleInputPassword1",class:"form-label",children:["Mobile Number",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),t(d,{name:"mobile",type:"number",placeholder:"Phone number",register:i,error:c.mobile,className:"",value:a.mobile,defaultValue:a.mobile?a.mobile:"",onChange:e=>{o({...a,mobile:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[t("label",{for:"exampleInputPassword1",class:"form-label",children:"Alternate Mobile Number"}),t(d,{name:"alternateMobile",type:"number",placeholder:"Phone number",register:i,error:c.alternateMobile,className:"",value:a.alternateMobile,defaultValue:a.alternateMobile?a.alternateMobile:"",onChange:e=>{o({...a,alternateMobile:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Email address"}),t(d,{name:"email",type:"email",placeholder:" Enter your email",register:i,error:c.email,className:"",value:a.email,defaultValue:a.email?a.email:"",onChange:e=>{o({...a,email:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Website"}),t(d,{name:"website",type:"text",placeholder:"",register:i,error:c.website,className:"",value:a.website,defaultValue:a.website?a.website:"",onChange:e=>{o({...a,website:e.target.value})}})]}),r("div",{class:"mb-3 col-lg-6",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Pincode"}),t(d,{name:"pincode",type:"number",placeholder:"Pincode",register:i,error:c.pincode,className:"",value:m.pincode,defaultValue:m.pincode?m.pincode:"",onChange:e=>{x({...m,pincode:e.target.value})}})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["Select Expertise",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"expertiseId",value:a.expertiseId,defaultValue:a.expertiseId?a.expertiseId:"",onChange:pe,children:[t("option",{value:"",children:"selct Experties"}),H.map(e=>t("option",{value:e._id,children:e.expertise},e._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["State",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm text-slate-500",id:"exampleInputYear","aria-describedby":"emailHelp",name:"stateName",value:m.stateID,defaultValue:m.stateID?m.stateID:"",onChange:e=>be(e),onBlur:u.handleBlur,children:[t("option",{value:"",children:"Select state"},""),E.map(e=>t("option",{value:e._id,children:e.state},e._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"cityInput",className:"form-label",children:["Home  Cities",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"homeCity",value:a.homeCity,defaultValue:a.homeCity?a.homeCity:"",onChange:he,onBlur:u.handleBlur,children:[t("option",{value:"",children:"Select city"},""),y.map(e=>t("option",{value:e._id,children:e.city},e._id))]})]}),r("div",{className:"mb-3 col-lg-6",children:[t("label",{htmlFor:"cityInput",className:"form-label",children:"Operational Cities"}),r("div",{className:"custom-select",children:[t("input",{type:"text",className:"form-control bg-white",placeholder:"Select Cities",value:f.map(e=>e.cityName).join(", "),defaultValue:f.map(e=>e.cityName).join(", "),readOnly:!0,onClick:te}),A&&t("div",{className:"select-options my-2",children:y.map(e=>r("div",{className:"form-check ",children:[t("input",{className:"form-check-input",type:"checkbox",id:e._id,value:e._id,checked:f.map(l=>l.cityId).includes(e._id),onChange:fe,disabled:f.length>=3&&!f.includes(e._id)}),t("label",{className:"form-check-label text-sm",htmlFor:e.city,children:e.city})]},e._id))})]})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"exampleInputYear",className:"form-label",children:["Starting Year",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm",id:"exampleInputYear","aria-describedby":"emailHelp",name:"yearOfEst",value:a.yearOfEst,defaultValue:a.yearOfEst?a.yearOfEst:"",onChange:ne,onBlur:u.handleBlur,children:[t("option",{value:"",className:"",children:"Select Year"}),B.map(e=>t("option",{value:e,children:e},e))]}),u.touched.year&&u.errors.year&&t("div",{className:"text-red-500 text-sm p-1",children:u.errors.year})]}),r("div",{class:"mb-3 col-lg-12",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Firm Address"}),t(d,{name:"address",type:"text",placeholder:"Enter firm address..",register:i,error:c.address,className:"",value:m.address,defaultValue:m.address?m.address:"",onChange:e=>{x({...m,address:e.target.value})}})]}),r("div",{className:"mb-3 col-lg-6",children:[r("label",{htmlFor:"exampleInputYear",className:"form-label",children:["Number Of Staff",t("span",{className:"text-red-400 text-lg mt-3",children:"*"})]}),r("select",{className:"form-select text-sm",id:"exampleInputYear",name:"staffCount","aria-describedby":"emailHelp",value:a.staffCount,defaultValue:a.staffCount?a.staffCount:"",onChange:ue,onBlur:u.handleBlur,children:[t("option",{value:"",className:"",children:"Select Number Of Staff"}),I.map(e=>t("option",{value:e,children:e},e))]}),u.touched.staffCount&&u.errors.staffCount&&t("div",{className:"text-red-500 text-sm p-1",children:u.errors.staffCount})]}),r("div",{className:"mb-3 col-lg-6",children:[t("label",{htmlFor:"exampleInputYear",className:"form-label",children:"Currunt Labour Strength"}),r("select",{className:"form-select text-sm",id:"exampleInputYear",name:"labourCount","aria-describedby":"emailHelp",value:a.labourCount,defaultValue:a.labourCount?a.labourCount:"",onChange:me,onBlur:u.handleBlur,children:[t("option",{value:"",className:"",children:"Select Labour Strength"}),ie.map(e=>t("option",{value:e,children:e},e))]})]}),r("div",{class:"mb-3 col-lg-12",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Authorised Applicators"}),t(d,{name:"authorisedApplicators",type:"text",placeholder:"Authorised Applicators",register:i,error:c.authorisedApplicators,className:"",value:a.authorisedApplicators,defaultValue:a.authorisedApplicators?a.authorisedApplicators:"",onChange:e=>{o({...a,authorisedApplicators:e.target.value})}})]}),r("div",{className:"mb-3 col-lg-12 flex items-center gap-4",children:[r("div",{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",value:"",checked:!!P,id:"flexCheckGST",onChange:e=>S(e,D)}),t("label",{className:"form-check-label text-sm font-medium",htmlFor:"flexCheckGST",children:"GST Number"})]}),r("div",{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",value:"",checked:!!F,id:"flexCheckPF",onChange:e=>S(e,_)}),t("label",{className:"form-check-label text-sm font-medium",htmlFor:"flexCheckPF",children:"PF Number"})]}),r("div",{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",value:"",checked:!!w,id:"flexCheckPAN",onChange:e=>S(e,R)}),t("label",{className:"form-check-label text-sm font-medium",htmlFor:"flexCheckPAN",children:"PAN Number"})]})]}),P&&t("div",{className:"mb-3 col-lg-7",children:t(d,{name:"gstNo",type:"number",placeholder:"Enter GST Number",register:i,error:c.gstNo,className:"",value:a.gstNo,defaultValue:a.gstNo?a.gstNo:"",onChange:e=>{o({...a,gstNo:e.target.value})}})}),F&&t("div",{className:"mb-3 col-lg-7",children:t(d,{name:"pfNo",type:"number",placeholder:"Enter PF Number",register:i,error:c.pfNo,className:"",value:a.pfNo,defaultValue:a.pfNo?a.pfNo:"",onChange:e=>{o({...a,pfNo:e.target.value})}})}),w&&t("div",{className:"mb-3 col-lg-7",children:t(d,{name:"panNo",type:"number",placeholder:"Enter PAN Number",register:i,error:c.panNo,className:"",value:a.panNo,defaultValue:a.panNo?a.panNo:"",onChange:e=>{o({...a,panNo:e.target.value})}})}),r("div",{class:"mb-3 col-lg-12",children:[t("label",{for:"exampleInputEmail1",class:"form-label",children:"Remark"}),t(d,{name:"remark",type:"text",placeholder:"",register:i,error:c.remark,className:"",value:a.remark,defaultValue:a.remark?a.remark:"",onChange:e=>{o({...a,remark:e.target.value})},id:"floatingTextarea2"})]}),ee?t(q,{children:t("button",{type:"submit",class:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:e=>le(),children:"Update"})}):t(q,{children:t("button",{type:"submit",class:"btn bg-[#00adee] hover:bg-[#6fcaeb] text-white text-lg",onClick:e=>V(),children:"Submit"})})]})})]})]})})}export{Me as default};
